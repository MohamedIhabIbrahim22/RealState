<!DOCTYPE html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Document</title> 
    <link rel="stylesheet" href="/css/AdminVillas.css">
</head> 
<body> 
    <div id="blured-space">
    <link rel="preconnect" href="https://fonts.googleapis.com"> 
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&family=Roboto:wght@300&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> 
    <%
    
function bufferToBase64(buffer) {
  return buffer.toString('base64');
}
    %>
    <div class="admin-prop-cards">
        <% for (let i = 0; i < arr.length; i++) { %>
            <div class="admin-prop-card" id="card-${x.id}">
                <% if (arr[i].image && arr[i].image.data) { %>
                    <% const base64Image = bufferToBase64(arr[i].image.data); %>
                    <img src="data:<%= arr[i].image.contentType %>;base64,<%= base64Image %>" alt="Image">
                <% } else { %>
                    <p>No image available</p>
                <% } %>
                <div class="card-content">
                    <h2><%= arr[i].name %></h2>
                    <p><%= arr[i].details %></p>
                    <a href="/AdminpageApartments.ejs?btn=<%=i%>" class="button">Find out more <span class="material-symbols-outlined">arrow_right_alt</span></a>
                    <div id="del">
                        <div id="del-<%=i%>" style="display:flex;justify-content: space-between;">
                            <input type="button" class="edit-button btn" value="edit" onclick="return show('<%=i%>')">
                            <form action="/Apartments/delete/<%= arr[i]._id %>" method="POST">
                                <input type="submit" value="Delete" class="btn">
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        <% } %>
    </div>
    </main>
    <div style="display:grid;justify-content:center;"><button style="background-color:white; border: none;" type="button" onclick="return dis()"><i class="fa fa-plus" style="font-size:48px;color:green"></i></button></div>
    </div>














<div id="admin-prop-add">
    <form id="admin-prop-myform" Name="AdminVillas" action="/Apartments" method="post" enctype="multipart/form-data">
        <div class="input-container">
            Images:<input id="admin-prop-formimg" name="image" type="file" accept="image/*">
            <h5 id="img-err" class="errormsgs"></h5>
        </div>
        <div class="form-section">
            <div class="input-container">
                Name:<input id="admin-prop-formname" name="name" type="text">
                <h5 id="name-err" class="errormsgs"></h5>
            </div>
            <div class="input-container">
                Details:<textarea id="admin-prop-formdetails" name="details" cols="20" row="4" placeholder="details"></textarea>
                <h5 id="details-err" class="errormsgs"></h5>
            </div>
        </div>
        <div class="form-section">
            <div class="input-container">
                Beds:<input id="admin-prop-formbeds" name="beds" type="number" min="0" step="1">
                <h5 id="beds-err" class="errormsgs"></h5>
            </div>
            <div class="input-container">
                Livingrooms:<input id="admin-prop-formlivingrooms" name="livingrooms" type="number" min="0" step="1">
                <h5 id="livingrooms-err" class="errormsgs"></h5>
            </div>
        </div>
        <div class="form-section">
            <div class="input-container">
                Toilets:<input id="admin-prop-formtoilets" name="toilets" type="number" min="0" step="1">
                <h5 id="toilets-err" class="errormsgs"></h5>
            </div>
            <div class="input-container">
                Garden:<input id="admin-prop-formgarden" name="garden" type="number" min="0" step="1">
                <h5 id="garden-err" class="errormsgs"></h5>
            </div>
        </div>
        <div class="form-section">
            <div class="input-container">
                Swimmingpools:<input id="admin-prop-formswimmingpools" name="swimmingpools" type="number" min="0" step="1">
                <h5 id="swimmingpools-err" class="errormsgs"></h5>
            </div>
            <div class="input-container">
                Price:<input id="admin-prop-formprice" name="price" type="number" min="0" step="1">
                <h5 id="price-err" class="errormsgs"></h5>
            </div>
        </div>
        <input type="submit" value="add" onclick="return validateForm()">
    </form>
</div>



<div id="admin-prop-edit">
<%for(let i=0;i<arr.length;i++){%>
<form class="edithiddenforms" id="form<%=i%>" action="/Apartments/edit/<%= arr[i]._id %>" method="POST" enctype="multipart/form-data">
    <div class="input-container">
        Images:<input id="admin-prop-formimg<%=i%>" name="image" type="file" accept="image/*">
        <h5 id="img-err<%=i%>" class="errormsgs"></h5>
    </div>
    <div class="form-section">
        <div class="input-container">
            Name:<input id="admin-prop-formname<%=i%>" name="name" type="text">
            <h5 id="name-err<%=i%>" class="errormsgs"></h5>
        </div>
        <div class="input-container">
            Details:<textarea id="admin-prop-formdetails<%=i%>" name="details" cols="20" row="4" placeholder="details"></textarea>
            <h5 id="details-err<%=i%>" class="errormsgs"></h5>
        </div>
    </div>
    <div class="form-section">
        <div class="input-container">
            Beds:<input id="admin-prop-formbeds<%=i%>" name="beds" type="number" min="0" step="1">
            <h5 id="beds-err<%=i%>" class="errormsgs"></h5>
        </div>
        <div class="input-container">
            Livingrooms:<input id="admin-prop-formlivingrooms<%=i%>" name="livingrooms" type="number" min="0" step="1">
            <h5 id="livingrooms-err<%=i%>" class="errormsgs"></h5>
        </div>
    </div>
    <div class="form-section">
        <div class="input-container">
            Toilets:<input id="admin-prop-formtoilets<%=i%>" name="toilets" type="number" min="0" step="1">
            <h5 id="toilets-err<%=i%>" class="errormsgs"></h5>
        </div>
        <div class="input-container">
            Garden:<input id="admin-prop-formgarden<%=i%>" name="garden" type="number" min="0" step="1">
            <h5 id="garden-err<%=i%>" class="errormsgs"></h5>
        </div>
    </div>
    <div class="form-section">
        <div class="input-container">
            Swimmingpools:<input id="admin-prop-formswimmingpools<%=i%>" name="swimmingpools" type="number" min="0" step="1">
            <h5 id="swimmingpools-err<%=i%>" class="errormsgs"></h5>
        </div>
        <div class="input-container">
            Price:<input id="admin-prop-formprice<%=i%>" name="price" type="number" min="0" step="1">
            <h5 id="price-err<%=i%>" class="errormsgs"></h5>
        </div>
    </div>
    <input type="submit" value="edit" onclick="return validateForm2('<%=i%>')">
</form>
<%}%>
</div>




<button id="adminvillasbackbtn" onclick="return backfromform()"><i class="fas fa-arrow-left"></i></button>
<button style="display:grid;position:absolute;top:0;right:0;" onclick="window.location.href = './Dashboard2.ejs'">Back to Dashboard<i class="fas fa-arrow-left"></i></button>

<script src="/js/script.js"></script>
</body>
</html>